<div class="flex justify-center mt-10 px-4">
  <div class="w-full max-w-xl bg-white dark:bg-gray-800 shadow-lg rounded-2xl p-6">
    <!-- Header -->
    <div class="border-b border-gray-200 dark:border-gray-700 pb-3 mb-4">
      <h4 class="text-xl font-semibold text-gray-800 dark:text-gray-100">
        {{ isEditMode ? 'Edit Department' : 'Create New Department' }}
      </h4>
    </div>

    <!-- Error Alert -->
    <div
      *ngIf="error"
      class="flex items-center justify-between bg-red-100 border border-red-300 text-red-700 px-4 py-3 rounded-lg mb-4"
      role="alert"
    >
      <span>{{ error }}</span>
      <button
        type="button"
        class="text-red-500 hover:text-red-700"
        (click)="error = ''"
      >
        âœ•
      </button>
    </div>

    <!-- Loading Spinner -->
    <div *ngIf="loading" class="flex justify-center items-center py-8">
      <div class="animate-spin rounded-full h-10 w-10 border-4 border-blue-500 border-t-transparent"></div>
    </div>

    <!-- Department Form -->
    <form *ngIf="!loading" [formGroup]="departmentForm" (ngSubmit)="onSubmit()" class="space-y-5">
      <!-- Department Name -->
      <div>
        <label for="deptName" class="block text-gray-700 dark:text-gray-200 font-medium mb-1">
          Department Name
        </label>
        <input
          id="deptName"
          type="text"
          formControlName="deptName"
          placeholder="Enter department name"
          [ngClass]="{
            'border-red-500 focus:ring-red-400': isFieldInvalid('deptName'),
            'border-gray-300 dark:border-gray-600': !isFieldInvalid('deptName')
          }"
          class="w-full rounded-xl border px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:outline-none dark:bg-gray-900 dark:text-gray-100 transition"
        />
        <p *ngIf="isFieldInvalid('deptName')" class="text-red-500 text-sm mt-1">
          {{ getFieldError('deptName') }}
        </p>
      </div>

      <!-- Department Code -->
      <div>
        <label for="deptCode" class="block text-gray-700 dark:text-gray-200 font-medium mb-1">
          Department Code
        </label>
        <input
          id="deptCode"
          type="text"
          formControlName="deptCode"
          placeholder="Enter department code (e.g., 1000)"
          [ngClass]="{
            'border-red-500 focus:ring-red-400': isFieldInvalid('deptCode'),
            'border-gray-300 dark:border-gray-600': !isFieldInvalid('deptCode')
          }"
          class="w-full rounded-xl border px-4 py-2.5 focus:ring-2 focus:ring-blue-500 focus:outline-none dark:bg-gray-900 dark:text-gray-100 transition"
        />
        <p *ngIf="isFieldInvalid('deptCode')" class="text-red-500 text-sm mt-1">
          {{ getFieldError('deptCode') }}
        </p>
      </div>

      <!-- Buttons -->
      <div class="flex justify-end gap-3 pt-3">
        <button
          type="button"
          (click)="onCancel()"
          [disabled]="submitting"
          class="bg-gray-300 hover:bg-gray-400 text-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-100 font-medium px-5 py-2.5 rounded-xl transition disabled:opacity-50"
        >
          Cancel
        </button>

        <button
          type="submit"
          [disabled]="departmentForm.invalid || submitting"
          class="flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white font-medium px-5 py-2.5 rounded-xl transition disabled:opacity-50"
        >
          <span *ngIf="submitting" class="animate-spin mr-2 border-2 border-white border-t-transparent rounded-full w-4 h-4"></span>
          {{ isEditMode ? 'Update' : 'Create' }} Department
        </button>
      </div>
    </form>
  </div>
</div>
