<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>{{ isEditMode ? 'Edit' : 'Add' }} Faculty Details</h2>
        <button routerLink="/faculty-details" class="btn btn-outline-secondary">
          <i class="fas fa-arrow-left"></i> Back to List
        </button>
      </div>

      <!-- Loading Spinner -->
      <div *ngIf="loading" class="text-center">
        <div class="spinner-border" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>

      <!-- Error Message -->
      <div *ngIf="error" class="alert alert-danger" role="alert">
        {{ error }}
      </div>

      <!-- Faculty Details Form -->
      <form *ngIf="!loading" [formGroup]="facultyDetailsForm" (ngSubmit)="onSubmit()">
        <div class="card mb-4">
          <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Basic Information</h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="facultyId" class="form-label">Faculty *</label>
                <select id="facultyId" formControlName="facultyId" class="form-select"
                  (change)="onFacultySelect(facultyDetailsForm.get('facultyId')?.value)">
                  <option value="">Select Faculty</option>
                  <option *ngFor="let faculty of faculties" [value]="faculty.id">
                    {{ faculty.name }} - {{ faculty.email }}
                  </option>
                </select>
                <div *ngIf="f['facultyId'].touched && f['facultyId'].invalid" class="text-danger">
                  <small *ngIf="f['facultyId'].errors?.['required']">Faculty is required</small>
                </div>
              </div>

              <div class="col-md-6 mb-3">
                <label for="employeeId" class="form-label">Employee ID *</label>
                <input type="text" id="employeeId" formControlName="employeeId" class="form-control"
                  placeholder="e.g., FAC-2024-001">
                <div *ngIf="f['employeeId'].touched && f['employeeId'].invalid" class="text-danger">
                  <small *ngIf="f['employeeId'].errors?.['required']">Employee ID is required</small>
                  <small *ngIf="f['employeeId'].errors?.['pattern']">Format: FAC-YYYY-NNN</small>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-4 mb-3">
                <label for="dateOfBirth" class="form-label">Date of Birth</label>
                <input type="date" id="dateOfBirth" formControlName="dateOfBirth" class="form-control">
              </div>

              <div class="col-md-4 mb-3">
                <label for="gender" class="form-label">Gender</label>
                <select id="gender" formControlName="gender" class="form-select">
                  <option value="">Select Gender</option>
                  <option *ngFor="let gender of genders" [value]="gender">{{ gender }}</option>
                </select>
              </div>

              <div class="col-md-4 mb-3">
                <label for="bloodGroup" class="form-label">Blood Group</label>
                <select id="bloodGroup" formControlName="bloodGroup" class="form-select">
                  <option value="">Select Blood Group</option>
                  <option *ngFor="let bg of bloodGroups" [value]="bg">{{ bg }}</option>
                </select>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="nationalId" class="form-label">National ID</label>
                <input type="text" id="nationalId" formControlName="nationalId" class="form-control">
              </div>

              <div class="col-md-6 mb-3">
                <label for="passportNumber" class="form-label">Passport Number</label>
                <input type="text" id="passportNumber" formControlName="passportNumber" class="form-control">
              </div>
            </div>
          </div>
        </div>

        <!-- Address Information -->
        <div class="card mb-4">
          <div class="card-header bg-secondary text-white">
            <h5 class="mb-0">Address Information</h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-12 mb-3">
                <label for="streetAddress" class="form-label">Street Address</label>
                <input type="text" id="streetAddress" formControlName="streetAddress" class="form-control">
              </div>
            </div>

            <div class="row">
              <div class="col-md-4 mb-3">
                <label for="city" class="form-label">City</label>
                <input type="text" id="city" formControlName="city" class="form-control">
              </div>

              <div class="col-md-4 mb-3">
                <label for="state" class="form-label">State</label>
                <input type="text" id="state" formControlName="state" class="form-control">
              </div>

              <div class="col-md-4 mb-3">
                <label for="country" class="form-label">Country</label>
                <input type="text" id="country" formControlName="country" class="form-control">
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="postalCode" class="form-label">Postal Code</label>
                <input type="text" id="postalCode" formControlName="postalCode" class="form-control">
              </div>
            </div>
          </div>
        </div>

        <!-- Professional Information -->
        <div class="card mb-4">
          <div class="card-header bg-info text-white">
            <h5 class="mb-0">Professional Information</h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="joiningDate" class="form-label">Joining Date *</label>
                <input type="date" id="joiningDate" formControlName="joiningDate" class="form-control">
                <div *ngIf="f['joiningDate'].touched && f['joiningDate'].invalid" class="text-danger">
                  <small *ngIf="f['joiningDate'].errors?.['required']">Joining date is required</small>
                </div>
              </div>

              <div class="col-md-6 mb-3">
                <label for="experienceYears" class="form-label">Experience (Years)</label>
                <input type="number" id="experienceYears" formControlName="experienceYears" class="form-control"
                  min="0">
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="qualification" class="form-label">Qualification</label>
                <input type="text" id="qualification" formControlName="qualification" class="form-control"
                  placeholder="e.g., PhD in Computer Science">
              </div>

              <div class="col-md-6 mb-3">
                <label for="specialization" class="form-label">Specialization</label>
                <input type="text" id="specialization" formControlName="specialization" class="form-control"
                  placeholder="e.g., Artificial Intelligence">
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="salaryScale" class="form-label">Salary Scale</label>
                <select id="salaryScale" formControlName="salaryScale" class="form-select">
                  <option value="">Select Salary Scale</option>
                  <option *ngFor="let scale of salaryScales" [value]="scale">{{ scale }}</option>
                </select>
              </div>

              <div class="col-md-6 mb-3">
                <label for="currentSalary" class="form-label">Current Salary</label>
                <input type="number" id="currentSalary" formControlName="currentSalary" class="form-control" min="0"
                  step="0.01">
              </div>
            </div>
          </div>
        </div>

        <!-- Additional Information -->
        <div class="card mb-4">
          <div class="card-header bg-warning text-dark">
            <h5 class="mb-0">Additional Information</h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-12 mb-3">
                <label for="bio" class="form-label">Bio</label>
                <textarea id="bio" formControlName="bio" class="form-control" rows="4"
                  placeholder="Brief biography..."></textarea>
              </div>
            </div>

            <div class="row">
              <div class="col-12 mb-3">
                <label for="researchInterests" class="form-label">Research Interests</label>
                <textarea id="researchInterests" formControlName="researchInterests" class="form-control" rows="3"
                  placeholder="Research interests separated by commas..."></textarea>
              </div>
            </div>

            <div class="row">
              <div class="col-12 mb-3">
                <label for="publications" class="form-label">Publications</label>
                <textarea id="publications" formControlName="publications" class="form-control" rows="3"
                  placeholder="Publications separated by commas..."></textarea>
              </div>
            </div>

            <div class="row">
              <div class="col-12 mb-3">
                <label for="awardsAchievements" class="form-label">Awards & Achievements</label>
                <textarea id="awardsAchievements" formControlName="awardsAchievements" class="form-control" rows="3"
                  placeholder="Awards and achievements separated by commas..."></textarea>
              </div>
            </div>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="d-flex justify-content-end gap-2">
          <button type="button" routerLink="/faculty-details" class="btn btn-outline-secondary">
            Cancel
          </button>
          <button type="submit" class="btn btn-primary" [disabled]="submitting || facultyDetailsForm.invalid">
            <span *ngIf="submitting" class="spinner-border spinner-border-sm me-2"></span>
            {{ isEditMode ? 'Update' : 'Create' }} Faculty Details
          </button>
        </div>
      </form>
    </div>
  </div>
</div>